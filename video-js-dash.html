<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible"
          content="ie=edge">
    <title>Video JS - Dash</title>

    <link href="https://s3.amazonaws.com/cdn.keyos.com/html5/videojs/7.5.4/video-js.min.css"
          rel="stylesheet">
    <link href="https://players.brightcove.net/videojs-quality-menu/1/videojs-quality-menu.css"
          rel='stylesheet'>

    <!-- <script type="text/javascript" src="https://unpkg.com/bonejs@0.0.1/mux.js"></script> -->
    <script src="https://s3.amazonaws.com/cdn.keyos.com/html5/videojs/7.5.4/video.min.js"></script>
    <script
            src="https://s3.amazonaws.com/cdn.keyos.com/html5/videojs-contrib-eme/3.5.4/videojs-contrib-eme.min.js"></script>

    <script src="https://players.brightcove.net/videojs-quality-menu/1/videojs-quality-menu.min.js"></script>



    <!-- Shaka  -->
    <script src="https://ajax.googleapis.com/ajax/libs/shaka-player/3.2.0/shaka-player.ui.js"></script>
    <link rel="stylesheet"
          href="https://ajax.googleapis.com/ajax/libs/shaka-player/3.2.0/controls.css">
  </head>

  <body>

    <h1>Video JS - DASH</h1>

    <video id="my-player"
           class="video-js"
           controls
           preload="auto">

    </video>



    <video id="video"
           width="640"
           controls></video>


    <!-- SHAKA -->
    <script type="text/javascript">
      ( () => {


        function initApp() {
          // Install built-in polyfills to patch browser incompatibilities.
          shaka.polyfill.installAll();

          // Check to see if the browser supports the basic APIs Shaka needs.
          if ( shaka.Player.isBrowserSupported() ) {
            // Everything looks good!
            initPlayer();
          } else {
            // This browser does not have the minimum set of APIs we need.
            console.error( 'Browser not supported!' );
          }
        }

        async function initPlayer() {
          // Create a Player instance.
          const video = document.getElementById( 'video' );
          const player = new shaka.Player( video );

          // Attach player to the window to make it easy to access in the JS console.
          window.player = player;


          player.configure( {
            drm: {
              servers: {
                'com.widevine.alpha': 'https://drm.adrennial.io?drm-type=widevine',
                'com.microsoft.playready': 'https://drm.adrennial.io?drm-type=playready'
              }
            }
          } );

          // Listen for error events.
          player.addEventListener( 'error', onErrorEvent );

          // Try to load a manifest.
          // This is an asynchronous process.
          try {
            await player.load( 'https://video.adrennial.io/vod/_definst_/smil:http/adrennial-media-store-prod/videos/uG4g726Jc9MU4RbZySZI4c931yC2/videos/fvyacMCPuHnW6Lac1CMN/1ffe8617-50c1-4ab4-a436-bf6c9f15b1bb.smil/manifest.mpd' );
            // This runs if the asynchronous load is successful.
            console.log( 'The video has now been loaded!' );
          } catch ( e ) {
            // onError is executed if the asynchronous load fails.
            onError( e );
          }
        }

        function onErrorEvent( event ) {
          // Extract the shaka.util.Error object from the event.
          onError( event.detail );
        }

        function onError( error ) {
          // Log the error.
          console.error( 'Error code', error.code, 'object', error );
        }

        document.addEventListener( 'DOMContentLoaded', initApp );
      } )();

    </script>

  </body>

</html>
